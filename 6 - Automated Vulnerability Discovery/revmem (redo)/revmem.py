import claripy
import angr

#All reversing challenges are solvable with angr. 
#There are tricks that make it harder (since symbolic values do not work when accessing memory)
#e.g. array index are not symbolic. The challenge is finding a workaround.

proj = angr.Project("./revmem")

argv = ['./revmem']
argv.append(claripy.BVS('arg1', 30*8)) # symbolic first argument

state = proj.factory.entry_state(args=argv)
simgr = proj.factory.simulation_manager(state)

simgr.explore(find=0x400000+0x1236, avoid=0x400000+0x1244) # explore...

if simgr.found:
    found = simgr.found[0]
    #import IPython
    #IPython.embed() #found -> found.se.constraints (it show all constraints generated)
    print(found.solver.eval(argv[1]).to_bytes(30, 'big')) # eval #this is used to print the flag found