from z3 import *




#function taken from ghidra and converted to python manually
def add_constraints(param_1, s):
    #1 k
    s.add(param_1[0xb] * -0x19 +
      param_1[8] * 0x31 + param_1[10] * 0xbb + -0x9c2a + param_1[1] * 0x39 + param_1[2] * 3 +
      param_1[0x16] * 0xd7 + param_1[9] * -0xbd + param_1[0xc] * -0x47 + param_1[0xd] * 0xb7 +
      param_1[0xf] * -0x9b + param_1[3] * 0x73 + param_1[0x13] * -0x95 + param_1[0xe] * 0xc6 +
      param_1[4] * 0x9a + param_1[0x11] * -0x66 + param_1[0x10] * 0x7c + param_1[0x12] * 0xb9 +
      param_1[6] * -0xaa + param_1[5] * -0x6a + param_1[0x15] * 0xe1 + param_1[0x14] * -0xa6 +
      param_1[7] * -0xb5 + param_1[0] * -0xb7 == 0)
  
    #2 k
    s.add(param_1[0x15] * -0x55 +
        param_1[0xe] * -0xe5 +
        param_1[8] * -0xae + param_1[6] * -0x58 + param_1[0x14] * 0x7d + param_1[1] * -0x3c +
        param_1[0xf] * 0xe0 + param_1[10] * 0xfc + param_1[2] * -0x5e + param_1[0x12] * -0xe0 +
        param_1[5] * 0xee + param_1[0x10] * 0xe7 + param_1[7] * -0x61 + param_1[0xb] * -0x89 +
        param_1[4] * -0x80 + param_1[0] * -0xfd + param_1[0xc] * -0x9e + 0x9a2e +
        param_1[0x16] * 2 + param_1[0x16] * -0x10 + param_1[0x13] * -0x11 + param_1[0x11] * 0x30 +
        param_1[0xd] * 0x83 + param_1[9] * -0xde + param_1[3] * 0xe2 == 0)

    #3 k
    s.add(param_1[0x10] * -0x39 +
          param_1[0x16] * 0xc6 +
          param_1[0x15] * -0x6c + param_1[9] * 0xd4 + param_1[0xf] * -0xe2 + param_1[0xd] * 0xc5 +
          param_1[0x14] * 0x91 + param_1[2] * 0x84 + param_1[1] * 0x32 + param_1[0xe] * 0x86 +
          -0x3124d + param_1[5] * 0xd2 + param_1[0x11] * 0xea + param_1[0xb] * 0x1b +
          param_1[0x12] * 0x97 + param_1[3] * 0xf0 + param_1[4] * -0x8a + param_1[0xc] * 0x95 +
          param_1[0x13] * 0x9f + param_1[7] * -0x29 + param_1[8] * 0xb3 + param_1[0] * -0x31 +
          param_1[10] * 0xd1 + param_1[6] * 0x32 == 0)

    #4 k
    s.add(param_1[7] * 0x5f +
            param_1[10] * 0x60 +
            param_1[0x14] * 0x8d + param_1[0xc] * 0xab + param_1[6] * -0x1a + param_1[0xe] * 0xcb +
            param_1[2] * 0x57 + param_1[0x13] * -0x8d + param_1[0x16] * -0xba + param_1[0xf] * 0xa9
            + param_1[0x10] * -0x14 + param_1[5] * 0x52 + param_1[0x11] * -0x23 + param_1[1] * -0x68
            + param_1[0x15] * 199 + param_1[0x12] * 0x57 + param_1[0xd] * 0xeb + param_1[8] * -0xa8
            + param_1[9] * 0x85 + param_1[0] * -0x62 + -0x20c1e + param_1[4] * 0xaf +
            param_1[3] * -0x26 + param_1[0xb] * 0xfb == 0)

    #5 k
    s.add(param_1[0xb] * 0x23 +
              param_1[3] * -0x80 + param_1[0x12] * 0xd0 + param_1[0xd] * 0x8a + -0x1b8ed +
              param_1[0] * -0x51 + param_1[2] * 0x8c + param_1[1] * 4 + param_1[0x13] * 0x86 +
              param_1[4] * 0xf0 + param_1[5] * -0xc4 + param_1[9] * -0x55 + param_1[0x14] * 0xd8 +
              param_1[0x11] * -0xb5 + param_1[0xe] * -0x14 + param_1[7] * 0xea + param_1[10] * -0xc3
              + param_1[8] * 0xeb + param_1[0xf] * 0xba + param_1[0x10] * -0xf5 +
              param_1[0x15] * 0xe7 + param_1[0xc] * 0x97 + param_1[0x16] * 0x97 + param_1[6] * -0x4e
              == 0)
    
    #6 k
    s.add(param_1[0xc] * 0xd6 +
                param_1[0x11] * -0x80 +
                param_1[3] * 0x21 + param_1[0xf] * -0xe8 + param_1[10] * 0xd + param_1[4] * -0x7b +
                param_1[0x12] * 0x5a + param_1[0x13] * 0xda + param_1[6] * -0x66 +
                param_1[1] * -0x98 + param_1[8] * 0x23 + param_1[0x14] * 0x16 +
                param_1[0x15] * -0x89 + param_1[9] * -0xba + param_1[7] * 0x53 + param_1[0xb] * 0x6e
                + param_1[2] * 0x8e + param_1[5] * -0xe5 + param_1[0xd] * 0xc5 + param_1[0x10] * -7
                + param_1[0x16] * -0xee + param_1[0] * 0xed + param_1[0xe] * 0xab + -0x3da5 == 0)
        
    #7 k
    s.add(param_1[1] * 0xa8 +
                  param_1[7] * -0xa6 +
                  ((param_1[6] * 0x7a + param_1[2] * -0x50 + param_1[0x12] * 0xdd +
                    param_1[4] * -0xa7 + param_1[5] * 0x8b + param_1[0xc] * -0x26 +
                    param_1[8] * -0x8c + param_1[0x10] * -0x9f + param_1[10] * -0xc6) -
                  param_1[0x16]) + param_1[0xe] * -0x35 + param_1[9] * 0xe +
                  param_1[0x14] * -0x6f + param_1[0xb] * 0x91 + 0xb2a6 + param_1[0x11] * -0x8d +
                  param_1[0xd] * -0xd + param_1[3] * 0x39 + param_1[0] * -0xcc + param_1[0xf] * -0x45
                  + param_1[0x13] * 0xe9 + param_1[0x15] * -0x6a == 0)
        
    #8 k
    s.add(param_1[0xe] * 0xe +
                    param_1[0x15] * 0xeb +
                    param_1[10] * 0x12 + param_1[0x13] * 0xa3 + param_1[3] * 0xa5 +
                    param_1[4] * 0xb3 + param_1[0xf] * -0x10 + param_1[0xc] * -0x4d +
                    param_1[2] * -0x65 + param_1[0x10] * 0xc1 + param_1[0x16] * 0x43 + -0x20fdc +
                    param_1[0x11] * 0xeb + param_1[0x14] * 0xb4 + param_1[5] * 0x33 +
                    param_1[0xd] * -0xe7 + param_1[9] * 0x7a + param_1[0] * -0x42 + param_1[1] * 0xca
                    + param_1[7] * 0xca + param_1[8] * 0x35 + param_1[0xb] * 0x4e +
                    param_1[0x12] * 0x4d + param_1[6] * -0xbe == 0)
        
    #9 k
    s.add(param_1[0x11] * -199 +
                      param_1[10] * -0x4e +
                      param_1[5] * -0xd8 + param_1[0xd] * -0x17 + param_1[7] * 0xc5 +
                      param_1[0xe] * 0x43 + param_1[0x10] * 0xc4 + param_1[0xf] * 0xaa + 0x4867 +
                      param_1[1] * -0xf5 + param_1[3] * -0xa1 + param_1[9] * 0x55 +
                      param_1[0x15] * 0x67 + param_1[0xc] * -0x4e + param_1[0x13] * 8 +
                      param_1[0] * -0xd3 + param_1[0x16] * -0xb2 + param_1[8] * 0x2d +
                      param_1[0xb] * -0xf + param_1[4] * 0xd1 + param_1[6] * 0xf2 +
                      param_1[2] * 0xf0 + param_1[0x14] * -0x5b + param_1[0x12] * 0x47 == 0)
        
    #10 k
    s.add(param_1[0x15] * 0xed +
                        param_1[0xe] * 0x5b +
                        param_1[4] * -0xf + param_1[9] * -0xfd + param_1[6] * 99 +
                        param_1[2] * -0xd1 + param_1[0] * 0xf7 + param_1[0x13] * 0xc3 +
                        param_1[0xf] * -0x6f + param_1[8] * 0xca + param_1[0x10] * 0x4a +
                        param_1[0x14] * 0xf9 + param_1[3] * 0xd3 + -0x130f0 + param_1[0x11] * -0xfc
                        + param_1[0x16] * -0xda + param_1[5] * 0x56 + param_1[10] * 0x3b +
                        param_1[0xb] * 0x87 + param_1[0xd] * -0x3a + param_1[0xc] * -0xa9 +
                        param_1[0x12] * 0xbb + param_1[1] * 0xb4 + param_1[7] * 0x8f == 0)
        
    #11 k
    s.add(param_1[0xf] * -0x20 +
                          param_1[0x16] * -0x22 +
                          param_1[0x15] * -0x7b + param_1[0xb] * -99 + param_1[0x13] * 0x86 +
                          param_1[0xe] * 0x9c + param_1[5] * 0x89 + param_1[0xd] * 0xe3 +
                          param_1[0x10] * -0x7c + param_1[3] * -0x9c + 0x8354 + param_1[0] * -0x45 +
                          param_1[1] * -0x51 + param_1[0x11] * -0x7d + param_1[7] * -0xa7 +
                          param_1[6] * 0xaf + param_1[8] * -0xcf + param_1[0x12] * -0xbf +
                          param_1[0x14] * 0x22 + param_1[4] * -0x3a + param_1[10] * -0x47 +
                          param_1[0xc] * -0x5d + param_1[2] * 0xfe + param_1[9] * 0xc9 == 0)
        
    #12 k
    s.add(param_1[10] * 0xcc +
                            param_1[0x13] * 0x33 +
                            param_1[2] * -0x69 + param_1[3] * -0xa3 + param_1[0x10] * 0x60 +
                            param_1[5] * 0xea + param_1[0xb] * -0xb5 + param_1[0xc] * 0x2a +
                            param_1[0x14] * 0xf1 + param_1[6] * 0xb1 + param_1[0xe] * -0x14 +
                            param_1[9] * 0x86 + param_1[0x12] * -0x65 + -0x53c7 + param_1[1] * -0x48
                            + param_1[4] * -0x30 + param_1[0xf] * -0xde + param_1[0x15] * -0x3e +
                            param_1[0] * 0x57 + param_1[8] * -0x37 + param_1[0xd] * 0x5a +
                            param_1[0x16] * 0x6c + param_1[0x11] * 0xd6 + param_1[7] * -0xe2 == 0)
        
    #13 k
    s.add(param_1[4] * 0x39 +
                              param_1[8] * 0x23 +
                              param_1[3] * -0x4e + param_1[0xb] * -0x99 + param_1[0xe] * 0x47 +
                              param_1[6] * -0xa7 + param_1[9] * 0x74 + param_1[0x14] * 2 + 0x2d4f +
                              param_1[0x12] * -0x50 + param_1[0xd] * -0xb8 + param_1[0x16] * -0x4f +
                              param_1[0x10] * -0x31 + param_1[0xf] * 0xf2 + param_1[0] * -7 +
                              param_1[0xc] * -0xa4 + param_1[0x11] * 0xc4 + param_1[7] * -0x28 +
                              param_1[0x13] * -0xb8 + param_1[5] * 0xf0 + param_1[1] * 0x1a +
                              param_1[2] * -0x84 + param_1[10] * 0x8d + param_1[0x15] * -2 == 0)
        
    #14 k
    s.add(param_1[4] * 0xa8 +
                                param_1[7] * 0xe1 +
                                param_1[0x12] * -0x1a + param_1[2] * -0x3d + param_1[0xf] * -0xc9 +
                                param_1[0x16] * -0x7f + param_1[0] * 0x2c + 0xeb6 +
                                param_1[0xb] * 0x71 + param_1[0x13] * -0x8f + param_1[0x10] * -0xdd
                                + param_1[10] * -0xe1 + param_1[6] * -0xbb + param_1[0x14] * 0x48 +
                                param_1[0xe] * -0xb6 + param_1[0xd] * 0xdc + param_1[3] * 0xf2 +
                                param_1[0x15] * -0x88 + param_1[0xc] * -0x2e + param_1[0x11] * 3 +
                                param_1[5] * 0xb8 + param_1[9] * 0x8c + param_1[8] * -0x77 +
                                param_1[1] + param_1[1] * -8 == 0)
        
    #15 k
    s.add(param_1[3] * 0xad +
                                  param_1[2] * 0x82 + param_1[0xf] * 0xa7 + param_1[7] * 0xd0 +
                                  param_1[0x14] * -0x4f + param_1[0xc] * -0x91 +
                                  param_1[0x11] * -0x5a + param_1[0x13] * -0x100 +
                                  param_1[0x10] * 0x27 + param_1[8] * 0xec + param_1[0xb] * 0x3c +
                                  param_1[6] * -0x4a + param_1[5] * -0x1b + param_1[4] * -0x47 +
                                  param_1[9] * 0x8c + param_1[0] * -0x8e + param_1[0x16] * 0x65 +
                                  param_1[10] * -0xb9 + param_1[0x15] * 0x74 + param_1[0xd] * -0x86
                                  + param_1[0xe] * 0x9e + param_1[1] * 0xbb + param_1[0x12] * -0x48
                                  == 0x6469)
        
    #16 k
    s.add(param_1[0x12] * -0xc0 +
                                    param_1[4] * 0xe7 +
                                    param_1[5] * 9 + param_1[8] * 0xa4 + param_1[0x15] * 0xf6 +
                                    param_1[2] * 0xd9 + param_1[0x11] * 0x57 + param_1[0xc] * -0x88
                                    + param_1[3] * 0xdd + param_1[0x10] * -0x8a + param_1[6] * -0x97
                                    + param_1[1] * 0x57 + param_1[0x13] * 0xe2 + param_1[7] * 0x61 +
                                    param_1[0x16] * 0x6c + param_1[0x14] * -0xd0 + -0x1e27d +
                                    param_1[0xf] * 0x46 + param_1[9] * 0xf0 + param_1[0] * 0x5a +
                                    param_1[0xd] * -0x52 + param_1[10] * 0xb9 + param_1[0xb] * 0xb4
                                    + param_1[0xe] * -0xf8 == 0)
        
    #17 k
    s.add(param_1[3] * 0xc +
                                      param_1[0xe] * 0x85 +
                                      param_1[6] * -0xa9 + param_1[0xb] * -0x36 +
                                      param_1[0x13] * -0x93 + param_1[8] * -0x17 + param_1[5] * 6 +
                                      param_1[0x14] * 0x99 + param_1[0x10] * 0xd4 +
                                      param_1[0xf] * 0xf2 + param_1[0xc] * 0xb5 +
                                      param_1[10] * -0xb8 + param_1[2] * -0x35 + param_1[9] * -0x98
                                      + param_1[0xd] * -0xe5 + -0x65d + param_1[4] * 0x3f +
                                      param_1[0] * 0x9d + param_1[1] * 0xe + param_1[0x11] * 0xe +
                                      param_1[0x16] * -0xdb + param_1[0x12] * 0x61 +
                                      param_1[7] * 0x1b + param_1[0x15] * -0x97 == 0)
        
    #18 k
    s.add(param_1[9] * 0xf6 +
                                        param_1[4] * -0x28 + 0x11400 + param_1[0xc] * -0xb2 +
                                        param_1[10] * -0xe2 + param_1[0xd] * -0x90 +
                                        param_1[0x16] * 0x62 + param_1[6] * 0xd3 +
                                        param_1[0x11] * -0x7a + param_1[0xb] * -0xad +
                                        param_1[8] * 0x1d + param_1[0x14] * 0x48 +
                                        param_1[2] * -0x17 + param_1[7] * -0x34 + param_1[3] * 0x9b
                                        + param_1[0x13] * -0x12 + param_1[0xf] * 0x7a +
                                        param_1[0x15] * -0x83 + param_1[0x10] * 0xac +
                                        param_1[5] * -0xe3 + param_1[0xe] * -0xb5 +
                                        param_1[0x12] * -0x8f + param_1[0] * 0xfc == 0)
        
    #19 k
    s.add(param_1[0x12] * -0x32 +
                                          param_1[0x13] * 0x50 +
                                          param_1[4] * -0x4f + param_1[0xb] * 0x4f + param_1[0] * 0x33
                                          + param_1[3] * -0xab + param_1[8] * -0x98 +
                                          param_1[0x15] * -0xcb + param_1[0x16] * 0x6a +
                                          param_1[9] * 0x95 + 0xfde0 + param_1[2] * -0xc1 +
                                          param_1[6] * -0x99 + param_1[5] * -0x40 +
                                          param_1[0x14] * -0x72 + param_1[0xf] * -0xf9 +
                                          param_1[0xc] * -0xfb + param_1[1] * 0xdc +
                                          param_1[0xe] * -0xf9 + param_1[0x11] * 0x17 +
                                          param_1[0x10] * -0x14 + param_1[7] * 0x7a +
                                          param_1[0xd] * 0x3d + param_1[10] * 0xdd == 0)
        
    #20 k
    s.add(param_1[0x16] * -0xfd +
                                            param_1[4] * 0x85 +
                                            param_1[0xb] * -0x29 + param_1[0x11] * 0x2a +
                                            param_1[0] * 0xe3 + param_1[1] * -0x84 + param_1[9] * 0xad
                                            + param_1[6] * 0x4c + param_1[0x14] * 0xf4 +
                                            param_1[5] * -0x2d + -0x21cf + param_1[7] * -0xc6 +
                                            param_1[0xe] * 0x4c + param_1[0x15] * -0x5a +
                                            param_1[3] * 0x65 + param_1[0xf] * -0xfe +
                                            param_1[8] * -0x29 + param_1[2] * -0x17 +
                                            param_1[0x13] * 0x8a + param_1[0xd] * -0x78 +
                                            param_1[0x10] * 0x6d + param_1[0x12] * -0x30 +
                                            param_1[10] * 0xa1 + param_1[0xc] * 0x8a == 0)
        
    #21 k
    s.add(param_1[10] * -0xb +
                                              param_1[0xe] * 0x54 +
                                              param_1[0x14] * 0x5b + param_1[2] * 0xda +
                                              param_1[3] * -0x8e + param_1[0x13] * 0x4c +
                                              param_1[0x15] * -0xec + param_1[0x10] * -0x81 +
                                              param_1[9] * -0x5c + param_1[0x16] * -0xdd +
                                              param_1[4] * 0xac + param_1[0xf] * 0xe5 +
                                              param_1[7] * -0xf9 + param_1[8] * -0x32 +
                                              param_1[5] * 0xbd + param_1[0x12] * -0xbd +
                                              param_1[0xd] * -100 + param_1[0xb] * 0x5d +
                                              param_1[1] * 0x8b + param_1[0xc] * 0x89 +
                                              param_1[0] * -0x1e + param_1[0x11] * -0x7c + -0x9bf +
                                              param_1[6] * -0x1e == 0)
        
    #22 k
    s.add(param_1[0xb] * -0xe2 +
                                                param_1[6] * -0x4b +
                                                param_1[0x15] * -10 + param_1[8] * 0x33 +
                                                param_1[0x16] * 0x72 + param_1[0x14] * -0x80 +
                                                param_1[5] * -0xdf + param_1[7] * 0xf9 +
                                                param_1[4] * 0x11 + param_1[0x11] * -0xc1 +
                                                param_1[0] * 0x74 + param_1[0x12] * 0xf6 +
                                                param_1[0x10] * 0xdc + param_1[0xf] * 0x65 +
                                                param_1[0xe] * 0xb2 + param_1[0xc] * -0x42 +
                                                param_1[10] * -0x42 + param_1[2] * 0x24 +
                                                param_1[9] * -0xd4 + param_1[0x13] * 0x73 +
                                                param_1[0xd] * -0x86 + param_1[3] * 0xd7 + -0xe3f6 +
                                                param_1[1] * 0x76 == 0)
        
    #23 k
    s.add(param_1[0x10] * -0x9c +
                                                  param_1[2] * 0x67 +
                                                  param_1[0xc] * -0x23 + param_1[8] * -0x48 +
                                                  param_1[6] * -0xd7 + param_1[7] * -0x84 +
                                                  param_1[1] * 10 + param_1[0xe] * -0xd7 +
                                                  param_1[0xb] * 0x62 + param_1[0xf] * -0x51 +
                                                  param_1[0] * 0xbc + param_1[0x16] * -0x4c + 0xd3bb +
                                                  param_1[0x13] * -0x98 + param_1[0xd] * -0x53 +
                                                  param_1[0x11] * -0x77 + param_1[0x15] * -0x6c +
                                                  param_1[3] * 0x74 + param_1[0x14] * 0x38 +
                                                  param_1[5] * 0x46 + param_1[9] * -0x9c +
                                                  param_1[4] * 0xdb + param_1[10] * -0x76 +
                                                  param_1[0x12] * 0x2e == 0)
    

s = Solver()
param_1 = [BitVec(f'{i}', 8) for i in range(23)] #8bit is 1 byte
state = add_constraints(param_1, s)
s.check()
final_value = s.model()

print("")

for i in range(len(param_1)): 
    print(chr(final_value[param_1[i]].as_long()), end='') 
#chr convert decimal to ascii #end='' change the last character with nocharacter instead of the standard newline to print the result inline #we use param_1 in order to mantain the same order and print the flag ordered

print("\n")

import IPython
IPython.embed() #look at seed and at state (call them in ipython exactly seed and state)

