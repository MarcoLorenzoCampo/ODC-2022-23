import claripy
import angr as angr


proj = angr.Project("prodkey")
keys = [claripy.BVS('c%d' % i, 8) for i in range (30)] # 30 bytes
input_string = claripy.Concat(*keys + [claripy.BVV(b'\n')])
initial_state = proj.factory.entry_state(stdin=input_string)

for k in keys:
    initial_state.solver.add(k >= 0x20, k <= 0x7e) #check that every char is actually printable

simgr = proj.factory.simulation_manager(initial_state) #simulation angr
simgr.explore(find=0x400e4e)

if simgr.found:
    #print(simgr.found[0].posix.dumps(0))
    print(simgr.found[0].posix.dumps(0).decode()) #put it as input to "nc bin.training.jinblack.it 2021" to get the flag
